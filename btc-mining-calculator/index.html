<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bitcoin Mining Profitability Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container my-4">
  <h1 class="mb-4">Bitcoin Mining Profitability per Machine</h1>
  <form id="miningForm" class="row g-3">
    <div class="col-md-4">
      <label for="hashrate" class="form-label"><b>Hashrate per machine</b> (TH/s):</label>
      <div class="input-group">
        <input type="number" class="form-control" id="hashrate" value="100" min="0" step="0.01" required />
        <span class="input-group-text">TH/s</span>
      </div>
    </div>
    <div class="col-md-4">
      <label for="machines" class="form-label"><b>Number of machines:</b></label>
      <input type="number" class="form-control" id="machines" value="1" min="1" step="1" required />
    </div>
    <div class="col-md-4">
      <label for="wattage" class="form-label"><b>Wattage per machine</b> (W):</label>
      <div class="input-group">
        <input type="number" class="form-control" id="wattage" value="3000" min="0" step="1" required />
        <span class="input-group-text">W</span>
      </div>
    </div>
    <div class="col-md-4">
      <label for="electricity" class="form-label"><b>Electricity price</b> ($/kWh):</label>
      <div class="input-group">
        <span class="input-group-text">$</span>
        <input type="number" class="form-control" id="electricity" value="0.10" min="0" step="0.001" required />
        <span class="input-group-text">per kWh</span>
      </div>
    </div>
    <div class="col-md-4">
      <label for="fee" class="form-label"><b>Pool fee</b> (%):</label>
      <div class="input-group">
        <input type="number" class="form-control" id="fee" value="1" min="0" step="0.1" required />
        <span class="input-group-text">%</span>
      </div>
    </div>
    <div class="col-md-4 d-flex align-items-end">
      <button type="button" id="calcBtn" class="btn btn-primary w-100">Calculate</button>
    </div>
  </form>
  <div id="results" class="mt-5 d-none">
    <h3 class="mb-3">Daily Mining Earnings:</h3>
    <table class="table table-bordered w-auto">
      <tbody>
        <tr><td><b>Gross BTC/day</b></td><td id="grossBtcVal">–</td></tr>
        <tr><td><b>Pool fee deduction</b></td><td id="feeVal">–</td></tr>
        <tr><td><b>Net BTC/day (≈ USD)</b></td><td id="netBtcVal">–</td></tr>
        <tr><td><b>Energy cost/day</b> (USD)</td><td id="costVal">–</td></tr>
        <tr><td><b>Net profit/day</b> (USD)</td><td id="profitVal">–</td></tr>
      </tbody>
    </table>
  </div>
</div>
<script>
  async function calculateMiningIncome() {
    const hashRateTH = parseFloat(document.getElementById('hashrate').value);
    const numMachines = parseInt(document.getElementById('machines').value);
    const watt = parseFloat(document.getElementById('wattage').value);
    const electricityCost = parseFloat(document.getElementById('electricity').value);
    const poolFeePercent = parseFloat(document.getElementById('fee').value);
    try {
      const [hashrateStr, rewardStr, priceData] = await Promise.all([
        fetch('https://blockchain.info/q/hashrate?cors=true').then(res => res.text()),
        fetch('https://blockchain.info/q/bcperblock?cors=true').then(res => res.text()),
        fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd').then(res => res.json())
      ]);
      const networkHashTH = parseFloat(hashrateStr) / 1000.0;
      const blockRewardBTC = parseFloat(rewardStr);
      const btcPrice = priceData.bitcoin.usd;
      const totalHashTH = hashRateTH * numMachines;
      const grossBTC = (totalHashTH / networkHashTH) * 144 * blockRewardBTC;
      const feeBTC = grossBTC * (poolFeePercent / 100.0);
      const netBTC = grossBTC - feeBTC;
      const netUSD = netBTC * btcPrice;
      const kWhPerDay = (watt * numMachines) * 24.0 / 1000.0;
      const dailyEnergyCost = kWhPerDay * electricityCost;
      const netProfitUSD = netUSD - dailyEnergyCost;
      document.getElementById('grossBtcVal').innerText = grossBTC.toFixed(8) + ' BTC';
      document.getElementById('feeVal').innerText = poolFeePercent.toFixed(2) + '% = ' + feeBTC.toFixed(8) + ' BTC';
      document.getElementById('netBtcVal').innerText = netBTC.toFixed(8) + ' BTC (≈ $' + netUSD.toFixed(2) + ')';
      document.getElementById('costVal').innerText = '$' + dailyEnergyCost.toFixed(2);
      document.getElementById('profitVal').innerText = '$' + netProfitUSD.toFixed(2);
      document.getElementById('results').classList.remove('d-none');
    } catch (err) {
      alert('Error fetching data. Please try again later.');
    }
  }
  document.getElementById('calcBtn').addEventListener('click', calculateMiningIncome);
</script>
</body>
</html>